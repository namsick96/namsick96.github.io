---
title: "로드 밸런서"
excerpt: 

categories:
    - Network
tags:
    - Network
last_modified_at: 2021-07-22T10:06:00-10:00
sitemap :
  changefreq : daily
  priority : 1.0
--- 

# 로드 밸런서
서버나 장비의 부하를 분산해주는 장비를 로드 밸런서라고 지칭합니다. L4에서 작동하는 로드 밸런서는 TCP,UDP정보를 가지고 로드 밸런싱을 수행합니다. 이러한 로드 밸런서는 Scale out을 위해서 꼭 필요한 장치입니다. 대표 IP를 로드 밸런서가 가지고 그 밑에 시스템을 병렬로 배치하여 각 시스템의 실제 IP로 로드 밸런서가 데이터를 보내는 방식으로 시스템을 구성할 수 있습니다. 보통 최근의 로드밸런서는 L4와 L7 계층 둘다를 지원합니다. L4는 TCP/UDP 정보를 기반으로, L7에서는 어플리케이션 프로토콜을 바탕으로 네트워크 트래픽을 분산시켜줍니다.

## L4 스위치

L4 스위치는 4계층에서 동작하는 로드 밸런서 기능이 있는 스위치입니다. 스위치는 2계층에서 활용되는 장비로 MAC 주소, 포트를 나타내는 테이블을 운용합니다. L4에서 명칭되는 스위치는 로드 밸런서이지만 스위치 처럼 여러개의 포트를 가지고 있습니다. L4스위치는 테이블에 로드밸런서(L4 스위치)로 오는 가상 ip주소와 서비스 포트를 가지고 있고 그에 매핑되는 서버의 리스트를 가지고 있습니다. 해당 서버는 리얼 IP를 가지고 있고 L4스위치는 가상 IP주소로 사용자에게 데이터를 받아 해당 데이터를 리얼 IP에 전달해줍니다. 이 과정에서 부하가 어떻게 분산될지 결정될 수 있습니다.

<img width="913" alt="스크린샷 2021-07-26 오전 11 43 41" src="https://user-images.githubusercontent.com/61309514/126926756-baac6236-356b-41af-928a-07e75d6cd366.png">



## ADC와 L4 스위치

ADC는 Application Delivery Controller의 약자로 L7(어플리케이션 계층)에서 작동하는 로드밸런서입니다. ADC는 어플리케이션 프로토콜의 헤더의 내용을 파탕으로 로드밸런싱, 정보 수정, 정보 필터링을 진행합니다. 대부분의 ADC들은 L4 스위치의 기능을 포함하고 L4계층과 어플리케이션 계층 둘 다에서 로드밸런싱을 지원합니다. 즉 L4 스위치가 ADC 안에 들어가 있는 것입니다. ADC는 원래 L7계층의 로드밸런서이지만 L4스위치의 기능을 추가하여 네트워크 장비로 기능합니다.

보안, 부하 분산의 측면에서 ADC는 L4스위치 보다 더 많은 일을 수행합니다. L4스위치는 TCP/UDP정보를 기반으로 부하를 분산하며 TCP레벨의 Dos 공격을 방어하거나 서버 부하를 분산시키기 위해 TCP세션 재사용과 같은 기능을 제공합니다. 기존 L4계층에서 작동하는 L4스위치의 기능을 포함하여 ADC는 어플리케이션 프로토콜을 이해해 어플리케이션 내용에 대한 분산,리디렉션,캐싱,최적화를 제공합니다. 또한 ADC는 SSL엔드포인트로 작동해 보안을 강화해주기도 합니다.

<br>
<br>
출처: IT엔지니어를 위한 네트워크 입문